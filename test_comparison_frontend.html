<!DOCTYPE html>
<html>
<head>
    <title>Test Comparison LLM Result Fix</title>
</head>
<body>
    <h1>Testing Comparison LLM Result Fix</h1>
    <div id="status">Loading...</div>
    <div id="results"></div>

    <script>
        async function testComparisonResultHandling() {
            const statusDiv = document.getElementById('status');
            const resultsDiv = document.getElementById('results');
            
            // Mock the expected result structure from backend
            const mockBackendResult = {
                llm_comparison: "## Detailed Comparison of PLC Code Files\n\nThis analysis compares two PLC code files...\n\n### Key Differences\n- Network 2: Safety interlocks differ between files\n- Additional logic found in analysis file\n\n### Recommendations\n- Review safety interlock changes\n- Validate new logic implementation"
            };
            
            statusDiv.innerHTML = '✅ Mock backend result created';
            
            // Test the frontend extraction logic (simulating what happens in the React components)
            function extractLLMResult(result) {
                return result?.llm_comparison || 'No LLM result.';
            }
            
            const extractedResult = extractLLMResult(mockBackendResult);
            
            if (extractedResult && extractedResult !== 'No LLM result.') {
                resultsDiv.innerHTML = `
                    <h2>✅ LLM Result Extraction Test: PASSED</h2>
                    <p><strong>Extracted result length:</strong> ${extractedResult.length} characters</p>
                    <p><strong>Preview:</strong></p>
                    <div style="background: #f5f5f5; padding: 10px; border-radius: 5px;">
                        ${extractedResult.substring(0, 200)}...
                    </div>
                `;
            } else {
                resultsDiv.innerHTML = `
                    <h2>❌ LLM Result Extraction Test: FAILED</h2>
                    <p>Got: ${extractedResult}</p>
                `;
            }
        }
        
        // Run the test
        testComparisonResultHandling();
    </script>
</body>
</html>
